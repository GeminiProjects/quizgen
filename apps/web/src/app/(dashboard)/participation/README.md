# Participation 模块实现

## 概述

Participation 模块已经按照 lectures 模块的模式进行了重构，提供了统一的用户体验和功能结构。

## 文件结构

```
participation/
├── page.tsx                    # 主页面 - 显示参与演讲列表
├── [Id]/
│   ├── page.tsx               # 详情页面 - 显示具体演讲详情
│   ├── content.tsx            # 详情内容组件
│   ├── quiz-test-tab.tsx      # 测验参与标签页
│   ├── exit-lecture.tsx       # 退出演讲对话框
│   └── loading.tsx            # 加载状态组件
├── join-lecture-dialog.tsx    # 加入演讲对话框
└── layout.tsx                 # 布局组件
```

## 主要功能

### 1. 主页面 (`page.tsx`)
- **面包屑导航**: 提供清晰的导航路径
- **统计卡片**: 显示参与演讲的统计数据
  - 参与演讲总数
  - 进行中的演讲数
  - 已完成的演讲数
  - 测验总数
  - 平均测验数
  - 活跃状态
- **搜索功能**: 支持按标题、描述、演讲者搜索
- **演讲列表**: 卡片式展示，支持悬停效果
- **加入演讲**: 通过对话框加入新演讲

### 2. 详情页面 (`[Id]/page.tsx`)
- **权限验证**: 检查用户是否参与了该演讲
- **数据获取**: 从数据库获取完整的演讲信息
- **统计计算**: 计算各种统计数据
- **错误处理**: 处理404和其他错误情况
- **加载状态**: 提供骨架屏加载效果

### 3. 详情内容 (`[Id]/content.tsx`)
- **页面头部**: 显示演讲标题、状态、描述
- **统计卡片**: 显示参与相关的统计数据
- **演讲信息**: 展示演讲的基本信息
- **功能标签页**: 
  - 测验参与: 显示可参与的测验列表
  - 参与进度: 显示参与进度（开发中）
  - 参与分析: 显示参与分析（开发中）
- **操作功能**: 返回列表、退出演讲

### 4. 测验参与 (`[Id]/quiz-test-tab.tsx`)
- **测验概览**: 显示测验统计信息
- **测验列表**: 显示所有可参与的测验
- **状态管理**: 区分已完成、待参与、已失败的状态
- **参与功能**: 点击参与测验
- **时间显示**: 显示发布时间和创建时间

## 数据流

1. **主页面**: 通过 SWR 获取参与演讲列表
2. **详情页面**: 服务端获取详细数据，包括统计信息
3. **测验标签页**: 通过 SWR 获取测验列表
4. **状态更新**: 通过 mutate 刷新数据

## 与 Lectures 模块的对比

| 功能 | Lectures | Participation |
|------|----------|---------------|
| 统计卡片 | 6个（管理相关） | 6个（参与相关） |
| 标签页 | 测验管理、材料管理、数据分析 | 测验参与、参与进度、参与分析 |
| 数据获取 | 服务端获取 | 服务端获取 + 客户端获取 |
| 权限控制 | 演讲所有者 | 演讲参与者 |
| 操作功能 | 编辑、删除、控制演讲 | 参与测验、退出演讲 |

## 技术特点

- **响应式设计**: 支持移动端和桌面端
- **加载状态**: 提供骨架屏和加载指示器
- **错误处理**: 完善的错误处理和用户提示
- **数据同步**: 使用 SWR 进行数据同步
- **类型安全**: TypeScript 支持
- **组件复用**: 复用 UI 组件和业务逻辑

## 后续开发

1. **参与进度标签页**: 实现参与进度的可视化
2. **参与分析标签页**: 实现参与数据的分析图表
3. **实时更新**: 添加 WebSocket 支持实时更新
4. **性能优化**: 优化数据获取和渲染性能 